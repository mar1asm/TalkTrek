<div class="search-page">
    <mat-sidenav-container class="container-nav mat-typography">
        <mat-sidenav class="nav-sidenav" #sidenav mode="side" [opened]="isFiltersPaneOpened"
            [class.sidenav-opened]="isFiltersPaneOpened">

            <mat-nav-list class="filters-pane">
                <div class="filter-item">
                    <div class="filter-item-label">Language</div>
                    <mat-form-field>
                        <mat-label>Select an option</mat-label>
                        <mat-select [(value)]="selectedFilters.language" (selectionChange)="filterTutors()">
                            <mat-option *ngFor="let language of availableLanguages "
                                [value]="language">{{language}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

                <div class="filter-item">
                    <div class="filter-item-label">Category</div>
                    <mat-form-field>
                        <mat-label>Select an option</mat-label>
                        <mat-select [(value)]="selectedFilters.teachingCategory" (selectionChange)="filterTutors()">
                            <mat-option *ngFor="let languageCategory of availableCategories "
                                [value]="languageCategory">{{languageCategory}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

                <div class="filter-item">
                    <div class="filter-item-label">Also speaks</div>
                    <mat-form-field>
                        <mat-label>Select at least one option</mat-label>
                        <mat-select [(value)]="selectedFilters.otherLanguages" multiple
                            (selectionChange)="filterTutors()">
                            <mat-option *ngFor="let otherLanguage of filterOutMainLanguage(availableOtherLanguages)"
                                [value]="otherLanguage">{{otherLanguage}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

                <div class="filter-item">
                    <div class="filter-item-label">Price</div>
                    <mat-slider class="price-slider" [min]="availablePriceRange.min" [max]="availablePriceRange.max"
                        discrete (change)="filterTutors()">

                        <input [(value)]="selectedFilters.priceRange.min" matSliderStartThumb>
                        <input [(value)]="selectedFilters.priceRange.max" matSliderEndThumb>
                    </mat-slider>
                </div>

                <div class="filter-item">
                    <div class="filter-item-label">Minimum rating</div>
                    <mat-form-field>
                        <mat-label>Select an option</mat-label>
                        <mat-select [(value)]="selectedFilters.minRating" (selectionChange)="filterTutors()">

                            <mat-option *ngFor="let minimumRating of minimumRatings" [value]="minimumRating">
                                {{ minimumRating ? minimumRating : 'Any' }}
                            </mat-option>

                            <!-- <mat-option *ngFor="let minimumRating of minimumRatings" [value]="minimumRating">
                                <mat-icon
                                    *ngFor="let star of [].constructor(minimumRating  - minimumRating % 1 )">star</mat-icon>
                                <mat-icon *ngIf="minimumRating % 1 !== 0">star_half</mat-icon>
                                <mat-icon *ngFor=" let star of [].constructor(5 - (minimumRating + minimumRating % 1))">
                                    star_border</mat-icon>
                            </mat-option> -->
                        </mat-select>
                    </mat-form-field>
                </div>
                <!-- <div class="filter-item">
                    <div class="filter-item-label">Availability</div>
                    <mat-form-field>
                        <mat-label>Select an option</mat-label>

                        <mat-select [(value)]="selectedIntervals" multiple>
                            <mat-select-trigger>
                                <ng-container
                                    *ngIf="selectedIntervals.length>0 && selectedIntervals.length !== availabilityIntervals.length">
                                    {{ selectedIntervals[0]}}

                                    <ng-container *ngIf="selectedIntervals.length > 1 ">
                                        <span class="additional-selection">
                                            (+{{ selectedIntervals.length - 1 }}
                                            {{ selectedIntervals.length === 2 ? 'other' : 'others' }})
                                        </span>
                                    </ng-container>
                                </ng-container>
                                <ng-container
                                    *ngIf="(selectedIntervals.length == availabilityIntervals.length) || (selectedIntervals.length == 0)">
                                    <span class="all-selected">
                                        Any
                                    </span>
                                </ng-container>
                            </mat-select-trigger>
                            <mat-option *ngFor="let interval of availabilityIntervals"
                                [value]="interval">{{interval}}</mat-option>
                        </mat-select>
                    </mat-form-field>


                    <div class="filter-item">
                        <div class="filter-item-label">Minimum experience</div>
                        <mat-form-field>
                            <mat-label>Select an option</mat-label>
                            <mat-select [(value)]="selectedMinimumExperience">
                                <mat-option *ngFor="let experience of minimumExperience "
                                    [value]="experience">{{experience}}
                                    {{ experience === 1 ? 'year' : 'years'}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>


                </div> -->
            </mat-nav-list>
        </mat-sidenav>



        <mat-sidenav-content class="search-tab">
            <div class="arrow-toggle-sidenav" (click)="onToggleFilterPane()">
                <mat-icon *ngIf="isFiltersPaneOpened">
                    keyboard_arrow_left
                </mat-icon>
                <mat-icon *ngIf="!isFiltersPaneOpened">
                    keyboard_arrow_right
                </mat-icon>
            </div>
            <div class="tutors-list">
                <div class="tutor-card" *ngFor=" let tutor of filteredTutors; let i = index" id="tutor-card{{i}}">

                    <div class="tutor-card-data">
                        <img class="tutor-card-image" mat-card-image src="{{tutor.photo}}" alt="tutor-image">
                        <div class="tutor-card-details" [class.expanded]="isDescriptionExpanded.get(tutor.id)"
                            [class.hidden]="!isDescriptionExpanded.get(tutor.id)">
                            <div class="tutor-card-details-name">
                                {{tutor.firstName}}
                            </div>

                            <div class="tutor-card-details-group">
                                <div class="tutor-card-details-item education">
                                    <mat-icon inline=true>school</mat-icon>
                                    <p>{{tutor.education}}</p>
                                </div>


                                <div class="tutor-card-details-item languages">
                                    <mat-icon inline=true>language</mat-icon>
                                    <div>{{ tutor.additionalLanguages | levelDescription }}</div>
                                </div>

                                <div class="tutor-card-details-item location">
                                    <mat-icon inline=true>location_on</mat-icon>
                                    <p>{{tutor.country}}</p>
                                </div>
                            </div>
                            <div class="tutor-card-details-item description"
                                [class.expanded]="isDescriptionExpanded.get(tutor.id) && isDescriptionOverflow.get(tutor.id) "
                                [class.hidden]="!isDescriptionExpanded.get(tutor.id)  && isDescriptionOverflow.get(tutor.id) "
                                #descriptionRef [id]="'description-' + tutor.id">
                                {{tutor.description}}
                            </div>
                            <div *ngIf="isDescriptionOverflow.get(tutor.id) "
                                class="tutor-card-details-button-container">
                                <button mat-button class="tutor-card-details-button"
                                    (click)="onToggleDescription(tutor.id)">Show
                                    {{isDescriptionExpanded.get(tutor.id)?
                                    'less':'more'}}</button>
                            </div>
                        </div>

                        <div class="tutor-card-info">
                            <div class="tutor-card-info-price">Lions {{ tutor.price }}/hr</div>



                            <div class="tutor-card-info-joined">
                                <p>Joined: {{tutor.accountCreationDate | date: "MMMM yyyy"}}</p>
                            </div>

                            <div class="tutor-card-info-classes">
                                <p>30 classes</p>
                            </div>

                            <div class="tutor-card-info-rating">
                                <mat-icon inline=true>star</mat-icon>
                                <p>{{tutor.rating}}/5</p>
                            </div>

                            <div class="tutor-card-info-reviews">
                                <p>{{tutor.reviews}} reviews</p>
                            </div>
                            <div class="tutor-card-info-buttons-container">

                                <button mat-flat-button class="tutor-card-button profile" color="accent"
                                    (click)="onTutorProfileButtonClicked(i)"> Profile
                                </button>
                                <!-- <button mat-flat-button class="tutor-card-button book" color="primary"
                                [routerLink]="'/tutor/' + i + '#book'"> Book
                            </button> -->
                            </div>
                        </div>
                    </div>
                    <!-- <div class="tutor-card-calendar" id="tutor-card-calendar{{i}}">
                        <mat-card class="calendar-card">
                            <mat-calendar [minDate]="startDateCalendar" [maxDate]="endDateCalendar"></mat-calendar>
                        </mat-card>
                    </div> -->
                </div>
            </div>
        </mat-sidenav-content>
    </mat-sidenav-container>


</div>